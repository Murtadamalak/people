import{d as T,g as M}from"./chunk-3VW6UYWH.js";import{a as B,b as v,c as U,d as j,f as $,g as G,h as L,i as R,k as q,m as Q}from"./chunk-WT3WPSVR.js";import{a as N}from"./chunk-AV447VWJ.js";import{a as z}from"./chunk-PP2E75A7.js";import{Ga as I,O as b,Pa as f,Qa as _,Ra as w,Sa as A,T as m,Ta as D,U as c,Ua as C,Va as e,Wa as t,Xa as p,Ya as S,Za as x,_a as d,cb as k,da as h,db as V,eb as i,fa as F,fb as s,gb as g,lb as E,ta as y,va as r,yb as P}from"./chunk-5THSZBG5.js";function K(l,u){if(l&1&&(e(0,"h1",4),i(1),t()),l&2){let n=d();r(),g("\u062A\u0639\u062F\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A: ",n.name)}}function O(l,u){if(l&1&&(e(0,"h1",4),i(1),t()),l&2){let n=d();r(),g("\u0645\u0644\u0641 \u0627\u0644\u0637\u0627\u0644\u0628: ",n.name)}}function W(l,u){if(l&1){let n=S();e(0,"button",18),x("click",function(){m(n);let a=d(2);return c(a.saveChanges())}),i(1," \u062D\u0641\u0638 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A "),t()}}function X(l,u){if(l&1){let n=S();e(0,"form",19),x("ngSubmit",function(){m(n);let a=d(2);return c(a.saveChanges())}),e(1,"div",10)(2,"div",20),p(3,"img",21),e(4,"input",22),x("change",function(a){m(n);let J=d(2);return c(J.onFileSelected(a))}),t()(),e(5,"div",23)(6,"div",24)(7,"label",25),i(8,"\u0627\u0644\u0627\u0633\u0645:"),t(),p(9,"input",26),t(),e(10,"div")(11,"label",25),i(12,"\u0627\u0644\u0635\u0641:"),t(),p(13,"input",27),t(),e(14,"div")(15,"label",25),i(16,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:"),t(),p(17,"input",28),t(),e(18,"div",24)(19,"label",25),i(20,"\u0627\u0644\u0642\u0633\u0637 \u0627\u0644\u0643\u0644\u064A:"),t(),p(21,"input",29),t(),e(22,"div",24)(23,"label",25),i(24,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A:"),t(),p(25,"textarea",30),t()()()()}if(l&2){let n,o=d(2);C("formGroup",o.studentForm),r(3),C("src",((n=o.studentForm.get("photoUrl"))==null?null:n.value)||"https://picsum.photos/200",y)}}function Y(l,u){if(l&1&&(e(0,"div",10)(1,"div",20),p(2,"img",21),t(),e(3,"div",31)(4,"div",32)(5,"p",33),i(6,"\u0627\u0644\u0627\u0633\u0645:"),t(),e(7,"span"),i(8),t()(),e(9,"div",32)(10,"p",33),i(11,"\u0627\u0644\u0635\u0641:"),t(),e(12,"span"),i(13),t()(),e(14,"div",32)(15,"p",33),i(16,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:"),t(),e(17,"span"),i(18),t()(),e(19,"div",32)(20,"p",33),i(21,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A:"),t(),e(22,"span"),i(23),t()(),e(24,"div",34)(25,"p",33),i(26,"\u0627\u0644\u0642\u0633\u0637 \u0627\u0644\u0643\u0644\u064A:"),t(),e(27,"span",35),i(28),t()(),e(29,"div",34)(30,"p",33),i(31,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0648\u0627\u0635\u0644:"),t(),e(32,"span",36),i(33),t()(),e(34,"div",34)(35,"p",33),i(36,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u062A\u0628\u0642\u064A:"),t(),e(37,"span",37),i(38),t()()()()),l&2){let n=d(),o=d();r(2),C("src",n.photoUrl||"https://picsum.photos/200",y),r(6),s(n.name),r(5),s(n.class),r(5),s(n.guardianPhone),r(5),s(n.notes||"\u0644\u0627 \u064A\u0648\u062C\u062F"),r(5),s(o.formatCurrency(n.totalFee)),r(5),s(o.formatCurrency(o.totalPaid())),r(5),s(o.formatCurrency(o.remainingBalance()))}}function Z(l,u){if(l&1&&(e(0,"div",38)(1,"p",39),i(2),t(),e(3,"p",40),i(4),t(),e(5,"p",41),i(6),t()()),l&2){let n=u.$implicit,o=u.$index,a=d(2);k("bg-green-50",n.amount>0)("bg-red-50",n.amount===0),r(2),g("\u0627\u0644\u0634\u0647\u0631 ",o+1),r(),k("text-green-700",n.amount>0)("text-red-700",n.amount===0),r(),s(a.formatCurrency(n.amount)),r(2),s(n.paymentDate?n.paymentDate:"\u0644\u0645 \u064A\u062F\u0641\u0639")}}function tt(l,u){if(l&1&&(e(0,"tr",53)(1,"td",63),i(2),t(),e(3,"td",64),i(4),t(),e(5,"td",63),i(6),t()()),l&2){let n=u.$implicit,o=u.$index,a=d(3);r(2),g("\u0627\u0644\u0634\u0647\u0631 ",o+1),r(2),s(a.formatCurrency(n.amount)),r(2),s(n.paymentDate||"-")}}function et(l,u){if(l&1){let n=S();e(0,"div",17)(1,"div",42)(2,"div",43)(3,"div",44),p(4,"img",45),e(5,"div")(6,"h1",46),i(7,"\u0648\u0635\u0644 \u0627\u0633\u062A\u0644\u0627\u0645 \u0623\u0642\u0633\u0627\u0637"),t(),e(8,"p",47),i(9),t(),e(10,"p",48),i(11),t(),e(12,"p",49),i(13),t()()(),e(14,"h2",50),i(15,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0623\u0642\u0633\u0627\u0637"),t(),e(16,"table",51)(17,"thead",52)(18,"tr",53)(19,"th",54),i(20,"\u0627\u0644\u0634\u0647\u0631"),t(),e(21,"th",54),i(22,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u062F\u0641\u0648\u0639"),t(),e(23,"th",54),i(24,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),t()()(),e(25,"tbody"),A(26,tt,7,3,"tr",53,w),t()(),e(28,"div",55)(29,"p",56)(30,"strong"),i(31,"\u0627\u0644\u0642\u0633\u0637 \u0627\u0644\u0643\u0644\u064A:"),t(),e(32,"span",35),i(33),t()(),e(34,"p",57)(35,"strong"),i(36,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0648\u0627\u0635\u0644:"),t(),e(37,"span",35),i(38),t()(),e(39,"p",58)(40,"strong"),i(41,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u062A\u0628\u0642\u064A:"),t(),e(42,"span",35),i(43),t()()(),e(44,"p",59),i(45,"\u0634\u0643\u0631\u0627\u064B \u0644\u062A\u0639\u0627\u0648\u0646\u0643\u0645!"),t()(),e(46,"div",60)(47,"button",61),x("click",function(){m(n);let a=d(2);return c(a.closePrintModal())}),i(48,"\u0625\u063A\u0644\u0627\u0642"),t(),e(49,"button",62),x("click",function(){m(n);let a=d(2);return c(a.executePrint())}),i(50,"\u0637\u0628\u0627\u0639\u0629"),t()()()()}if(l&2){let n=d(),o=d();r(4),C("src",n.photoUrl||"https://picsum.photos/200",y),r(5),s(n.name),r(2),s(n.class),r(2),g("\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0637\u0628\u0627\u0639\u0629: ",o.printDate),r(13),D(n.installments),r(7),s(o.formatCurrency(n.totalFee)),r(5),s(o.formatCurrency(o.totalPaid())),r(5),s(o.formatCurrency(o.remainingBalance()))}}function nt(l,u){if(l&1){let n=S();e(0,"div")(1,"div",2)(2,"div",3)(3,"div"),f(4,K,2,1,"h1",4)(5,O,2,1,"h1",4),t(),e(6,"div",5)(7,"button",6),x("click",function(){m(n);let a=d();return c(a.toggleEditMode())}),i(8),t(),f(9,W,2,0,"button",7),e(10,"button",8),x("click",function(){m(n);let a=d();return c(a.triggerPrint())}),i(11,"\u0637\u0628\u0627\u0639\u0629 \u0648\u0635\u0644"),t()()(),f(12,X,26,2,"form",9)(13,Y,39,8,"div",10),e(14,"div",11)(15,"h2",12),i(16,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0623\u0642\u0633\u0627\u0637"),t(),e(17,"div",13),A(18,Z,7,11,"div",14,w),t()(),e(20,"div",15)(21,"button",16),x("click",function(){m(n);let a=d();return c(a.toggleFontSize())}),i(22," \u062A\u0643\u0628\u064A\u0631/\u062A\u0635\u063A\u064A\u0631 \u0627\u0644\u062E\u0637 "),t()()(),f(23,et,51,7,"div",17),t()}if(l&2){let n=d();V(n.fontSizeClass()),r(4),_(n.isEditing()?4:5),r(4),g(" ",n.isEditing()?"\u0625\u0644\u063A\u0627\u0621":"\u062A\u0639\u062F\u064A\u0644"," "),r(),_(n.isEditing()?9:-1),r(3),_(n.isEditing()?12:13),r(6),D(u.installments),r(5),_(n.showPrintModal()?23:-1)}}function it(l,u){l&1&&(e(0,"div",1)(1,"p"),i(2,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0627\u0644\u0637\u0627\u0644\u0628. \u0642\u062F \u064A\u0643\u0648\u0646 \u0627\u0644\u0631\u0627\u0628\u0637 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D."),t(),e(3,"a",65),i(4," \u0627\u0644\u0639\u0648\u062F\u0629 \u0625\u0644\u0649 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0637\u0644\u0627\u0628 "),t()())}var H=class l{constructor(){this.route=b(T);this.studentService=b(z);this.notificationService=b(N);this.fb=b(q);this.student=E(()=>{let u=this.route.snapshot.paramMap.get("id");return this.studentService.students().find(n=>n.id===Number(u))});this.isEditing=h(!1);this.fontSizeClass=h("text-base");this.showPrintModal=h(!1);this.printDate=new Date().toLocaleDateString("ar-IQ");this.studentForm=this.fb.group({id:[0],name:["",v.required],class:["",v.required],guardianPhone:["",v.required],totalFee:[0,[v.required,v.min(1)]],notes:[""],photoUrl:[null],installments:this.fb.array([])});this.totalPaid=E(()=>{let u=this.student();return u?this.studentService.calculateTotalPaid(u):0});this.remainingBalance=E(()=>{let u=this.student();return u?u.totalFee-this.totalPaid():0});F(()=>{let u=this.student();u&&this.studentForm.patchValue(u)})}toggleEditMode(){this.student()&&(this.isEditing.set(!this.isEditing()),this.isEditing()&&this.studentForm.patchValue(this.student()))}onFileSelected(u){let n=u.target.files?.[0];if(n){let o=new FileReader;o.onload=()=>{this.studentForm.patchValue({photoUrl:o.result})},o.readAsDataURL(n)}}saveChanges(){this.studentForm.valid&&(this.studentService.updateStudent(this.studentForm.value),this.notificationService.show("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D!"),this.isEditing.set(!1))}triggerPrint(){this.showPrintModal.set(!0)}executePrint(){window.print()}closePrintModal(){this.showPrintModal.set(!1)}toggleFontSize(){this.fontSizeClass.update(u=>u==="text-base"?"text-lg":u==="text-lg"?"text-xl":"text-base")}formatCurrency(u){return new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0}).format(u)}static{this.\u0275fac=function(n){return new(n||l)}}static{this.\u0275cmp=I({type:l,selectors:[["app-student-detail"]],decls:2,vars:1,consts:[[3,"class"],[1,"text-center","py-12","text-gray-500"],["id","view-section",1,"bg-white","p-8","rounded-xl","shadow-lg"],[1,"flex","justify-between","items-start","mb-6","border-b","pb-4"],[1,"text-3xl","font-bold","text-sky-700"],[1,"flex","space-i-2","no-print"],[1,"bg-yellow-500","text-white","px-4","py-2","rounded-lg","hover:bg-yellow-600","transition-colors",3,"click"],[1,"bg-green-500","text-white","px-4","py-2","rounded-lg","hover:bg-green-600","transition-colors"],[1,"bg-sky-600","text-white","px-4","py-2","rounded-lg","hover:bg-sky-700","transition-colors",3,"click"],[3,"formGroup"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8"],[1,"mt-10"],[1,"text-2xl","font-bold","text-sky-700","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-7","gap-4"],[1,"border","rounded-lg","p-4","text-center",3,"bg-green-50","bg-red-50"],[1,"mt-8","text-center","no-print"],[1,"text-sm","bg-gray-200","text-gray-700","px-4","py-2","rounded-lg","hover:bg-gray-300",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-60","flex","items-center","justify-center","z-50","p-4"],[1,"bg-green-500","text-white","px-4","py-2","rounded-lg","hover:bg-green-600","transition-colors",3,"click"],[3,"ngSubmit","formGroup"],[1,"md:col-span-1"],["alt","\u0635\u0648\u0631\u0629 \u0627\u0644\u0637\u0627\u0644\u0628",1,"w-48","h-48","rounded-full","object-cover","mx-auto","shadow-md",3,"src"],["type","file","accept","image/*",1,"mt-4","block","w-full","text-sm","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-sky-50","file:text-sky-700","hover:file:bg-sky-100",3,"change"],[1,"md:col-span-2","grid","grid-cols-2","gap-4"],[1,"col-span-2"],[1,"font-bold"],["formControlName","name",1,"w-full","p-2","border","rounded-md"],["formControlName","class",1,"w-full","p-2","border","rounded-md"],["formControlName","guardianPhone",1,"w-full","p-2","border","rounded-md"],["type","number","formControlName","totalFee",1,"w-full","p-2","border","rounded-md"],["formControlName","notes","rows","3",1,"w-full","p-2","border","rounded-md"],[1,"md:col-span-2","space-y-4"],[1,"flex","items-baseline"],[1,"font-bold","w-32"],[1,"flex","items-baseline","text-lg"],[1,"font-mono"],[1,"text-green-600","font-semibold","font-mono"],[1,"text-red-600","font-semibold","font-mono"],[1,"border","rounded-lg","p-4","text-center"],[1,"text-sm","font-semibold","text-gray-500"],[1,"text-xl","font-bold","my-2","font-mono"],[1,"text-xs","text-gray-400"],[1,"bg-white","rounded-lg","shadow-2xl","max-w-2xl","w-full","max-h-full","overflow-y-auto"],["id","print-section",1,"p-10"],[1,"flex","items-start","space-i-6","mb-6"],["alt","\u0635\u0648\u0631\u0629 \u0627\u0644\u0637\u0627\u0644\u0628",1,"w-32","h-32","rounded-lg","object-cover","shadow-md",3,"src"],[1,"text-2xl","font-bold","text-sky-800","mb-2"],[1,"text-lg","font-semibold"],[1,"text-sm","text-gray-600"],[1,"text-sm","text-gray-600","mt-2"],[1,"text-xl","font-bold","text-sky-700","mb-4","border-t","pt-4"],[1,"w-full","text-sm","text-right"],[1,"bg-gray-50"],[1,"border-b"],[1,"py-2","px-4","text-right","font-semibold"],[1,"mt-6","border-t","pt-4","text-sm","space-y-2"],[1,"flex","justify-between","font-semibold"],[1,"flex","justify-between","font-semibold","text-green-600"],[1,"flex","justify-between","font-semibold","text-red-600"],[1,"text-xs","text-center","mt-8","text-gray-500"],[1,"p-6","bg-gray-50","rounded-b-lg","text-right","space-i-2","no-print","sticky","bottom-0"],[1,"bg-gray-500","text-white","px-6","py-2","rounded-lg","hover:bg-gray-600","transition-colors",3,"click"],[1,"bg-sky-600","text-white","px-6","py-2","rounded-lg","hover:bg-sky-700","transition-colors",3,"click"],[1,"py-2","px-4"],[1,"py-2","px-4","font-mono"],["routerLink","/students",1,"mt-4","inline-block","bg-sky-600","text-white","px-4","py-2","rounded-lg","hover:bg-sky-700"]],template:function(n,o){if(n&1&&f(0,nt,24,7,"div",0)(1,it,5,0,"div",1),n&2){let a;_((a=o.student())?0:1,a)}},dependencies:[P,M,Q,$,B,G,U,j,R,L],encapsulation:2,changeDetection:0})}};export{H as StudentDetailComponent};
