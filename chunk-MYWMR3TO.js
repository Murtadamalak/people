import{a as M,c as V,e as N,l as $}from"./chunk-WT3WPSVR.js";import{a as A}from"./chunk-AV447VWJ.js";import{a as F}from"./chunk-PP2E75A7.js";import{Ga as k,O as y,Pa as I,Qa as E,Ra as T,Sa as S,T as c,Ta as v,U as p,Ua as C,Va as n,Wa as i,Ya as g,Za as x,_a as d,a as f,b as w,da as b,eb as a,fb as _,gb as P,lb as h,va as s,yb as D}from"./chunk-5THSZBG5.js";var L=(u,e)=>e.id;function O(u,e){if(u&1){let t=g();n(0,"li",9),x("click",function(){let l=c(t).$implicit,o=d(2);return p(o.selectStudent(l))}),n(1,"div")(2,"p",10),a(3),i(),n(4,"p",11),a(5),i()(),n(6,"span",12),a(7,"\u0627\u062E\u062A\u0631"),i()()}if(u&2){let t=e.$implicit;s(3),_(t.name),s(2),_(t.class)}}function J(u,e){u&1&&(n(0,"li",8),a(1," \u0644\u0627 \u064A\u0648\u062C\u062F \u0637\u0644\u0627\u0628 \u064A\u0637\u0627\u0628\u0642\u0648\u0646 \u0627\u0644\u0628\u062D\u062B. "),i())}function Q(u,e){if(u&1){let t=g();n(0,"div")(1,"div",2)(2,"label",3),a(3,"\u0627\u0628\u062D\u062B \u0623\u0648 \u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628\u0627\u064B \u0645\u0646 \u0627\u0644\u0642\u0627\u0626\u0645\u0629"),i(),n(4,"input",4),x("ngModelChange",function(l){c(t);let o=d();return p(o.searchTerm.set(l))}),i()(),n(5,"div",5)(6,"ul",6),S(7,O,8,2,"li",7,L,!1,J,2,0,"li",8),i()()()}if(u&2){let t=d();s(4),C("ngModel",t.searchTerm()),s(3),v(t.filteredStudents())}}function H(u,e){if(u&1){let t=g();n(0,"div")(1,"label",24),a(2),i(),n(3,"input",25),x("change",function(l){let o=c(t).$index,m=d(2);return p(m.updateInstallment(o,l))}),i()()}if(u&2){let t=e.$implicit,r=e.$index;s(2),P("\u0627\u0644\u0634\u0647\u0631 ",r+1),s(),C("value",t.amount)}}function q(u,e){if(u&1){let t=g();n(0,"div")(1,"div",13)(2,"h2",14),a(3),i(),n(4,"p",15),a(5),i()(),n(6,"div",16),S(7,H,4,2,"div",null,T),i(),n(9,"div",17)(10,"div",18)(11,"span",19),a(12,"\u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0648\u0627\u0635\u0644 \u0627\u0644\u062C\u062F\u064A\u062F:"),i(),n(13,"span",20),a(14),i()(),n(15,"div",21)(16,"button",22),x("click",function(){c(t);let l=d();return p(l.cancel())}),a(17,"\u0625\u0644\u063A\u0627\u0621"),i(),n(18,"button",23),x("click",function(){c(t);let l=d();return p(l.savePayments())}),a(19,"\u062D\u0641\u0638 \u0627\u0644\u062F\u0641\u0639\u0627\u062A"),i()()()()}if(u&2){let t,r,l,o=d();s(3),_((t=o.selectedStudent())==null?null:t.name),s(2),_((r=o.selectedStudent())==null?null:r.class),s(2),v((l=o.selectedStudent())==null?null:l.installments),s(7),_(o.formatCurrency(o.totalPaid()))}}var j=class u{constructor(){this.studentService=y(F);this.notificationService=y(A);this.searchTerm=b("");this.selectedStudent=b(null);this.filteredStudents=h(()=>{let e=this.searchTerm().toLowerCase(),t=this.studentService.students();return e?t.filter(r=>r.name.toLowerCase().includes(e)):t});this.totalPaid=h(()=>{let e=this.selectedStudent();return e?this.studentService.calculateTotalPaid(e):0})}selectStudent(e){this.selectedStudent.set(JSON.parse(JSON.stringify(e))),this.searchTerm.set("")}updateInstallment(e,t){let r=Number(t.target.value);this.selectedStudent.update(l=>{if(l){let o=f({},l),m=[...o.installments],B=m[e].amount;return m[e]=w(f({},m[e]),{amount:r,paymentDate:r>0&&B===0?new Date().toISOString().split("T")[0]:r===0?null:m[e].paymentDate}),o.installments=m,o}return null})}savePayments(){let e=this.selectedStudent();e&&(this.studentService.updateStudent(e),this.notificationService.show(`\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0623\u0642\u0633\u0627\u0637 \u0627\u0644\u0637\u0627\u0644\u0628 ${e.name}`),this.selectedStudent.set(null))}cancel(){this.selectedStudent.set(null)}formatCurrency(e){return new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0}).format(e)}static{this.\u0275fac=function(t){return new(t||u)}}static{this.\u0275cmp=k({type:u,selectors:[["app-pay-installment"]],decls:5,vars:1,consts:[[1,"max-w-4xl","mx-auto","bg-white","p-8","rounded-xl","shadow-lg"],[1,"text-3xl","font-bold","text-sky-700","mb-6","border-b","pb-4"],[1,"mb-4"],["for","search",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","search","placeholder","\u0627\u0643\u062A\u0628 \u062C\u0632\u0621 \u0645\u0646 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0644\u062A\u0635\u0641\u064A\u0629 \u0627\u0644\u0642\u0627\u0626\u0645\u0629...",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-sky-500","focus:border-sky-500","block","w-full","p-2.5",3,"ngModelChange","ngModel"],[1,"mt-4","max-h-96","overflow-y-auto","border","rounded-lg"],[1,"divide-y","divide-gray-200"],[1,"p-4","cursor-pointer","hover:bg-sky-50","flex","justify-between","items-center","transition-colors"],[1,"p-4","text-center","text-gray-500"],[1,"p-4","cursor-pointer","hover:bg-sky-50","flex","justify-between","items-center","transition-colors",3,"click"],[1,"font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-sky-500","font-semibold"],[1,"mb-6","p-4","bg-sky-50","rounded-lg"],[1,"text-xl","font-semibold","text-sky-800"],[1,"text-sm","text-gray-600"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"mt-8","border-t","pt-4","flex","justify-between","items-center"],[1,"text-lg"],[1,"font-semibold"],[1,"font-bold","text-green-600"],[1,"space-i-2"],[1,"bg-gray-500","text-white","px-6","py-2","rounded-lg","hover:bg-gray-600","transition-colors",3,"click"],[1,"bg-sky-600","text-white","px-6","py-2","rounded-lg","hover:bg-sky-700","transition-colors",3,"click"],[1,"block","mb-1","text-sm","font-medium","text-gray-700"],["type","number",1,"w-full","p-2","border","border-gray-300","rounded-md","text-center","focus:ring-sky-500","focus:border-sky-500","bg-white","text-gray-900","shadow-sm",3,"change","value"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"h1",1),a(2,"\u062A\u0633\u062F\u064A\u062F \u0642\u0633\u0637 \u0634\u0647\u0631\u064A"),i(),I(3,Q,10,2,"div")(4,q,20,3,"div"),i()),t&2&&(s(3),E(r.selectedStudent()?4:3))},dependencies:[D,$,M,V,N],encapsulation:2,changeDetection:0})}};export{j as PayInstallmentComponent};
